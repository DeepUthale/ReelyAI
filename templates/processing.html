{% extends "base.html" %}
{% block title %}Generating Reel...{% endblock %}

{% block content %}
<div style="min-height:60vh; display:flex; align-items:center; justify-content:center; flex-direction:column; gap:14px; text-align:center;">
  <h2>Generating your reelâ€¦</h2>
  <p>Please wait. This can take a few seconds.</p>
  <div class="spinner-border" role="status"></div>
</div>
{% endblock %}

{% block extra_js %}
<script>
  const jobId = "{{ job_id }}";

  async function poll() {
    const res = await fetch(`/status/${jobId}`);
    const data = await res.json();

    if (data.status === "finished") {
      window.location.href = "/gallery";
      return;
    }
    if (data.status === "failed") {
      alert("Generation failed. Check server logs.");
      window.location.href = "/create";
      return;
    }

    setTimeout(poll, 1200);
  }
  poll();
</script>
{% endblock %}
